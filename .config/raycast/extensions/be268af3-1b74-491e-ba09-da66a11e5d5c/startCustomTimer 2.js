"use strict";var w=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var I=Object.prototype.hasOwnProperty;var A=(r,t)=>{for(var i in t)w(r,i,{get:t[i],enumerable:!0})},k=(r,t,i,l)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of x(t))!I.call(r,n)&&n!==i&&w(r,n,{get:()=>t[n],enumerable:!(l=V(t,n))||l.enumerable});return r};var H=r=>k(w({},"__esModule",{value:!0}),r);var J={};A(J,{default:()=>O});module.exports=H(J);var o=require("@raycast/api"),N=require("react");var m=require("@raycast/api"),D=require("child_process"),F=require("crypto"),d=require("fs");var C=r=>{let t=Math.floor(r/3600),i=String(Math.floor(r%3600/60)).padStart(2,"0"),l=String(Math.floor(r%60)).padStart(2,"0");return`${t}:${i}:${l}`};var T=m.environment.supportPath+"/customTimers.json";async function P(r,t="Untitled",i="default"){let n=(m.environment.supportPath+"/"+new Date().toISOString()+"---"+r+".timer").replace(/:/g,"__");(0,d.writeFileSync)(n,t);let c=(0,m.getPreferenceValues)(),h=`${m.environment.assetsPath+"/"+(i==="default"?c.selectedSound:i)}`,a=[`sleep ${r}`];a.push(`if [ -f "${n}" ]; then osascript -e 'display notification "Timer \\"${t}\\" complete" with title "Ding!"'`);let g=`afplay "${h}" --volume ${c.volumeSetting.replace(",",".")}`;if(c.selectedSound==="speak_timer_name"?a.push(`say "${t}"`):a.push(g),c.ringContinuously){let f=`${n}`.replace(".timer",".dismiss");(0,d.writeFileSync)(f,".dismiss file for Timers"),a.push(`while [ -f "${f}" ]; do ${g}; done`)}a.push(`rm "${n}"; else echo "Timer deleted"; fi`),(0,D.exec)(a.join(" && "),(f,S)=>{if(f){console.log(`error: ${f.message}`);return}if(S){console.log(`stderr: ${S}`);return}}),(0,m.popToRoot)(),await(0,m.showHUD)(`Timer "${t}" started for ${C(r)}! \u{1F389}`)}function v(){(0,d.existsSync)(T)||(0,d.writeFileSync)(T,JSON.stringify({}))}function E(r){v();let t=JSON.parse((0,d.readFileSync)(T,"utf8"));t[(0,F.randomUUID)()]=r,(0,d.writeFileSync)(T,JSON.stringify(t))}var p=require("@raycast/api"),M=[{title:"Alarm Clock",icon:p.Icon.Alarm,value:"alarmClock.wav"},{title:"Dismembered Woodpecker",icon:p.Icon.Bird,value:"dismemberedWoodpecker.wav"},{title:"Flute Riff",icon:p.Icon.Music,value:"fluteRiff.wav"},{title:"Level Up",icon:p.Icon.Trophy,value:"levelUp.wav"},{title:"Piano Chime",icon:p.Icon.Music,value:"pianoChime.wav"},{title:"Terminator",icon:p.Icon.BarCode,value:"terminator.wav"},{title:"Speak Timer Name",icon:p.Icon.Person,value:"speak_timer_name"}];var u=require("react/jsx-runtime");function O(r){let t=Object.values(r.arguments).some(e=>e!==""),[i,l]=(0,N.useState)(),[n,c]=(0,N.useState)(),[h,a]=(0,N.useState)(),g=e=>{if(v(),e.hours===""&&e.minutes===""&&e.seconds==="")new o.Toast({style:o.Toast.Style.Failure,title:"No values set for timer length!"}).show();else if(isNaN(Number(e.hours)))l("Hours must be a number!");else if(isNaN(Number(e.minutes)))c("Minutes must be a number!");else if(isNaN(Number(e.seconds)))a("Seconds must be a number!");else{(0,o.closeMainWindow)();let s=e.name?e.name:"Untitled",$=3600*Number(e.hours)+60*Number(e.minutes)+Number(e.seconds);P($,s,e.selectedSound),e.willBeSaved&&E({name:e.name,timeInSeconds:$,selectedSound:e.selectedSound})}},f=()=>{i&&i.length>0&&l(void 0)},S=()=>{n&&n.length>0&&c(void 0)},y=()=>{h&&h.length>0&&a(void 0)},b=[{id:"hours",title:"Hours",placeholder:"0",err:i,drop:f,validator:e=>{let s=e.target.value;isNaN(Number(s))?l("Hours must be a number!"):f()}},{id:"minutes",title:"Minutes",placeholder:"00",err:n,drop:S,validator:e=>{let s=e.target.value;isNaN(Number(s))?c("Minutes must be a number!"):S()}},{id:"seconds",title:"Seconds",placeholder:"00",err:h,drop:y,validator:e=>{let s=e.target.value;isNaN(Number(s))?a("Seconds must be a number!"):y()}}];return(0,o.getPreferenceValues)().newTimerInputOrder!=="hhmmss"&&b.reverse(),(0,u.jsxs)(o.Form,{actions:(0,u.jsx)(o.ActionPanel,{children:(0,u.jsx)(o.Action.SubmitForm,{title:"Start Custom Timer",onSubmit:e=>g(e)})}),children:[b.map((e,s)=>(0,u.jsx)(o.Form.TextField,{id:e.id,title:e.title,placeholder:e.placeholder,defaultValue:r.arguments[e.id],error:e.err,onChange:e.drop,onBlur:e.validator},s)),(0,u.jsxs)(o.Form.Dropdown,{id:"selectedSound",defaultValue:"default",title:"Sound",children:[(0,u.jsx)(o.Form.Dropdown.Item,{value:"default",title:"Default"}),M.map((e,s)=>(0,u.jsx)(o.Form.Dropdown.Item,{title:e.title,value:e.value,icon:e.icon},s))]}),(0,u.jsx)(o.Form.TextField,{id:"name",title:"Name",placeholder:"Pour Tea",autoFocus:t}),(0,u.jsx)(o.Form.Checkbox,{id:"willBeSaved",label:"Save as preset"})]})}0&&(module.exports={});
