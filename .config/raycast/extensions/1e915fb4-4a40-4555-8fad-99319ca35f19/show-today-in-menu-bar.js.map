{
  "version": 3,
  "sources": ["../node_modules/osascript-tag/dist/index.js", "../src/show-today-in-menu-bar.tsx", "../src/shared.ts"],
  "sourcesContent": ["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ChildProcess = __importStar(require(\"child_process\"));\nfunction isTemplateString(value) {\n    return Array.isArray(value) && Object.prototype.hasOwnProperty.call(value, 'raw');\n}\nfunction buildString(strings, replacements) {\n    var result = '';\n    var totalStrings = strings.length;\n    for (var i = 0; i < totalStrings; i++) {\n        var value = i < totalStrings - 1 ? replacements[i] : '';\n        result += strings[i] + value;\n    }\n    return result.trim();\n}\nfunction runScript(strings, replacements, options) {\n    if (options === void 0) { options = {}; }\n    if (process.platform !== 'darwin') {\n        return Promise.reject(new Error('osascript-tag requires macOS'));\n    }\n    return new Promise(function (resolve, reject) {\n        var argv = options.argv || [];\n        var flags = [];\n        var script = buildString(strings, replacements);\n        var language = 'AppleScript';\n        if (options.language === 'JavaScript') {\n            language = options.language;\n            script = \"(function(...argv){\" + script + \"})(\" + argv.map(function (value) { return JSON.stringify(value); }) + \")\";\n        }\n        if (options.parse) {\n            flags = ['-s', 's'];\n        }\n        if (typeof options.flags === 'string') {\n            flags = ['-s', options.flags];\n        }\n        var child = ChildProcess.spawn('osascript', ['-l', language].concat(flags, ['-e', script]));\n        var errorString = '';\n        child.stderr.on('data', function (error) {\n            errorString += error.toString();\n        });\n        var dataString = '';\n        child.stdout.on('data', function (data) {\n            dataString += data.toString();\n        });\n        child.on('close', function () {\n            if (errorString) {\n                reject(errorString);\n            }\n            else {\n                var result = dataString;\n                if (options.parse) {\n                    try {\n                        result = JSON.parse(dataString);\n                    }\n                    catch (error) {\n                        reject(error);\n                    }\n                }\n                resolve(result);\n            }\n        });\n        child.on('error', function (error) {\n            reject(error);\n        });\n    });\n}\nfunction osascript(scriptOrOptions) {\n    var replacementsArray = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        replacementsArray[_i - 1] = arguments[_i];\n    }\n    if (isTemplateString(scriptOrOptions)) {\n        return runScript(scriptOrOptions, replacementsArray, {});\n    }\n    return function (script) {\n        var replacements = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            replacements[_i - 1] = arguments[_i];\n        }\n        return runScript(script, replacements, scriptOrOptions);\n    };\n}\nfunction execJXA(scriptOrOptions) {\n    var replacementsArray = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        replacementsArray[_i - 1] = arguments[_i];\n    }\n    if (isTemplateString(scriptOrOptions)) {\n        return runScript(scriptOrOptions, replacementsArray, {\n            language: 'JavaScript',\n        });\n    }\n    return function (strings) {\n        var replacements = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            replacements[_i - 1] = arguments[_i];\n        }\n        return runScript(strings, replacements, __assign({ language: 'JavaScript' }, scriptOrOptions));\n    };\n}\nosascript.jxa = execJXA;\nexports.jxa = execJXA;\nexports.default = osascript;\n", "import { MenuBarExtra, Icon, open } from '@raycast/api';\nimport { useEffect, useState } from 'react';\nimport { Todo, ListName, getListTodos, setTodoProperty } from './shared';\n\nconst TASK_NAME_LENGTH_LIMIT = 30;\n\nexport default function ShowCurrentTaskCommand() {\n  const [todos, setTodos] = useState<Todo[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  async function refresh() {\n    try {\n      setTodos(await getListTodos(ListName.Today));\n    } catch (err) {\n      // Do nothing\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  async function completeTaskAndRefresh(id: string) {\n    await setTodoProperty(id, 'status', 'completed');\n    return refresh();\n  }\n\n  useEffect(() => {\n    refresh();\n  }, []);\n\n  const tooltip = todos.length > 0 ? todos[0].name : '';\n  const title = tooltip.length > TASK_NAME_LENGTH_LIMIT ? tooltip.substring(0, TASK_NAME_LENGTH_LIMIT) + '\u2026' : tooltip;\n\n  return (\n    <MenuBarExtra icon=\"things-icon.png\" title={title} tooltip={tooltip} isLoading={isLoading}>\n      {todos.length > 0 ? (\n        <>\n          <MenuBarExtra.Item\n            title=\"Complete\"\n            icon={Icon.CheckCircle}\n            onAction={() => {\n              completeTaskAndRefresh(todos[0].id);\n            }}\n          />\n          <MenuBarExtra.Separator />\n          <MenuBarExtra.Item title=\"Today\" />\n        </>\n      ) : null}\n\n      {todos.map((todo: Todo) => (\n        <MenuBarExtra.Item\n          title={todo.name}\n          key={todo.id}\n          onAction={() => {\n            open(`things:///show?id=${todo.id}`);\n          }}\n        />\n      ))}\n    </MenuBarExtra>\n  );\n}\n", "import { showToast, Toast, getPreferenceValues } from '@raycast/api';\nimport osascript from 'osascript-tag';\n\ntype Preferences = {\n  thingsAppIdentifier: string;\n};\n\nenum TodoStatus {\n  open = 'open',\n  completed = 'completed',\n  canceled = 'canceled',\n}\n\nexport interface Todo {\n  id: string;\n  name: string;\n  status: TodoStatus;\n  tags: string;\n  project: TodoGroup;\n  area: TodoGroup;\n  dueDate: string;\n  notes: string;\n  // creationDate: string;\n  // activationDate: string;\n  // modificationDate: string;\n  // completionDate: string;\n  // cancellationDate: string;\n}\n\nexport interface TodoGroup {\n  id: string;\n  name: string;\n  tags: string;\n  area?: TodoGroup;\n}\n\nexport const preferences: Preferences = getPreferenceValues();\n\nexport const executeJxa = async (script: string) => {\n  try {\n    const result = await osascript.jxa({ parse: true })`${script}`;\n    return result;\n  } catch (err: unknown) {\n    if (typeof err === 'string') {\n      const message = err.replace('execution error: Error: ', '');\n      if (message.match(/Application can't be found/)) {\n        showToast({\n          style: Toast.Style.Failure,\n          title: 'Application not found',\n          message: 'Things must be running',\n        });\n      } else {\n        showToast({\n          style: Toast.Style.Failure,\n          title: 'Something went wrong',\n          message: message,\n        });\n      }\n    }\n  }\n};\n\nexport const thingsNotRunningError = `\n  ## Things Not Running\n  Please make sure Things is installed and running before using this extension.\n  \n  ### But my Things app is running!\n  If Things is running, you may need to grant Raycast access to Things in *System Settings > Privacy & Security > Automation > Raycast > Things*\n`;\n\nexport enum ListName {\n  Inbox = 'Inbox',\n  Today = 'Today',\n  Anytime = 'Anytime',\n  Upcoming = 'Upcoming',\n  Someday = 'Someday',\n}\n\nconst listNameToListIdMapping = {\n  Inbox: 'TMInboxListSource',\n  Today: 'TMTodayListSource',\n  Anytime: 'TMNextListSource',\n  Upcoming: 'TMCalendarListSource',\n  Someday: 'TMSomedayListSource',\n};\n\nexport const getListTodos = (listName: ListName) =>\n  executeJxa(`\n  const things = Application('${preferences.thingsAppIdentifier}');\n  const todos = things.lists.byId('${listNameToListIdMapping[listName]}').toDos();\n  return todos.map(todo => ({\n    id: todo.id(),\n    name: todo.name(),\n    status: todo.status(),\n    notes: todo.notes(),\n    tags: todo.tagNames(),\n    dueDate: todo.dueDate() && todo.dueDate().toISOString(),\n    project: todo.project() && {\n      id: todo.project().id(),\n      name: todo.project().name(),\n      tags: todo.project().tagNames(),\n      area: todo.project().area() && {\n        id: todo.project().area().id(),\n        name: todo.project().area().name(),\n        tags: todo.project().area().tagNames(),\n      },\n    },\n    area: todo.area() && {\n      id: todo.area().id(),\n      name: todo.area().name(),\n      tags: todo.area().tagNames(),\n    },\n  }));\n`);\n\nexport const setTodoProperty = (todoId: string, key: string, value: string) =>\n  executeJxa(`\n  const things = Application('${preferences.thingsAppIdentifier}');\n  things.toDos.byId('${todoId}').${key} = '${value}';\n`);\n\nexport const deleteTodo = (todoId: string) =>\n  executeJxa(`\n  const things = Application('${preferences.thingsAppIdentifier}');\n  things.delete(things.toDos.byId('${todoId}'));\n`);\n\nexport const getTodoGroupId = (todo: Todo) => todo.project?.id || todo.area?.id;\nexport const getTodoGroup = (todo: Todo) => todo.project || todo.area;\n"],
  "mappings": "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",
  "names": ["require_dist", "__commonJSMin", "exports", "__assign", "s", "i", "n", "p", "__importStar", "mod", "result", "k", "ChildProcess", "isTemplateString", "value", "buildString", "strings", "replacements", "totalStrings", "runScript", "options", "resolve", "reject", "argv", "flags", "script", "language", "child", "errorString", "error", "dataString", "data", "osascript", "scriptOrOptions", "replacementsArray", "_i", "execJXA", "show_today_in_menu_bar_exports", "__export", "ShowCurrentTaskCommand", "__toCommonJS", "import_api", "import_react", "import_api", "import_osascript_tag", "preferences", "executeJxa", "script", "osascript", "err", "message", "listNameToListIdMapping", "getListTodos", "listName", "executeJxa", "preferences", "setTodoProperty", "todoId", "key", "value", "import_jsx_runtime", "TASK_NAME_LENGTH_LIMIT", "ShowCurrentTaskCommand", "todos", "setTodos", "isLoading", "setIsLoading", "refresh", "getListTodos", "completeTaskAndRefresh", "id", "setTodoProperty", "tooltip", "title", "todo"]
}
